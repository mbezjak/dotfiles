#!/bin/bash
#

set -o errexit

project=$(basename $PWD)
dirty=$(hg dirty)

if [[ "$dirty" -eq 0 ]]; then
   cin=$(hg cin)
   cout=$(hg cout)

   if [[ "$cin" -eq 0 ]]; then
       [[ "$cout" -ne 0 ]] && hg push
   elif [[ "$cout" -eq 0 ]]; then
       hg pull --update
   else
       echo "$project in $cin out $cout"
   fi
else
    echo "$project dirty $dirty"
fi

exit 0
