#!/bin/bash
#
# run as:
# $ git stub

set -o errexit

root=/tmp/git-stub
mkdir $root
cd    $root

newrepo()  { mkdir $root/$1; cd $root/$1; git init; addempty $1 first; }
clone()    { cd $root; git clone $1 $2; }
addempty() {
  cd $root/$1; touch $2; git add .
  git ci -m "Add empty file named '$2'."
}
content()  {
  cd $root/$1; echo $3 > $2; git add .
  git ci -m "Change '$2' to: '$3'."
}

# fast-forward
newrepo  01-main
clone    01-main 01-ff
addempty 01-main a
addempty 01-main b
addempty 01-main c

# rebase-from-main
newrepo  02-main
clone    02-main 02-rebase
addempty 02-rebase a
addempty 02-rebase b
addempty 02-main   c
addempty 02-main   d

# merge-to-main
newrepo  03-main
clone    03-main 03-merge
addempty 03-merge a
addempty 03-merge b
addempty 03-main  c
addempty 03-main  d

# merge conflict
newrepo  04-main
addempty 04-main a
clone    04-main 04-conflict
content  04-main     a "content-from-main"
content  04-conflict a "content-from-conflict"

exit 0
