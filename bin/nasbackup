#!/bin/bash
#

set -o errexit

mountdir=/mnt/nas
from="$HOME"
to="$mountdir/backup/arch"

nasmount()   { sudo mount.nfs nas:/mnt/ide1/public $mountdir; }
nasunmount() { sudo umount $mountdir; }
backup()     {
  src="$from/$1"
  dest="$to/$2"
  shift 2
  rdiff-backup --verbosity 5 --print-statistics "$@" "$src" "$dest"
}


nasmount

backup bin bin
backup Documents Documents
backup Dropbox Dropbox
backup lib lib
backup .mozilla mozilla --exclude '**/Cache'
backup workspace workspace --exclude '**.class' --exclude '**/bin' \
                           --exclude '**/build' --exclude '**/target'

nasunmount

exit 0
